%% docs/diagrams/azure-architecture.mmd
%% High-level Azure architecture (flowchart, safe labels)
flowchart LR
  subgraph GitHub["GitHub Actions (OIDC)"]
    GH["Deploy Workflow manual"]
  end

  subgraph RG["Azure Resource Group incident-rg"]
    ASP["App Service Plan Linux Basic"]
    API["Web App incident-api Managed Identity Always On health"]
    KV["Key Vault incident-kv RBAC"]
    DB["PostgreSQL Flexible incident-db database incidentdb"]
    LAW["Log Analytics Workspace"]
    AI["Application Insights workspace based"]
    BUD["Budget 100 USD per month"]
  end

  GH -->|deploy| API
  GH -->|migrations| DB
  GH -->|secrets| KV

  API -->|kv refs| KV
  API -->|telemetry| AI
  AI --> LAW
  API -->|pgsql| DB
